<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Helping Hand - Profile</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Teko:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header header-home">
    <a href="home.html" class="logo">
      <img src="assets/hh-logo-1.png" alt="Helping Hand Logo" class="logo-img">
      <span class="logo-text">Helping Hand</span>
    </a>
    <nav class="nav-links">
      <a href="profile.html" class="active">Profile</a>
      <a href="#history">History</a>
      <a href="#settings">Settings</a>
      <button class="btn-logout" id="logoutBtn">ğŸšª Logout</button>
    </nav>
  </header>

  <section class="profile-hero">
    <div class="profile-hero-content">
      <div class="profile-avatar-large" id="profileAvatar">ğŸ‘¤</div>
      <div class="profile-info">
        <h1 id="profileName">User Name</h1>
        <p class="profile-type" id="profileType">Customer</p>
        <div class="profile-stats">
          <div class="profile-stat">
            <span class="stat-value">12</span>
            <span class="stat-label">Services</span>
          </div>
          <div class="profile-stat">
            <span class="stat-value">2024</span>
            <span class="stat-label">Member Since</span>
          </div>
          <div class="profile-stat">
            <span class="stat-value">$468</span>
            <span class="stat-label">Total Spent</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <main class="profile-main">
    <div class="profile-grid">
      <div class="profile-card">
        <div class="card-header-row">
          <h3>ğŸ“‹ Personal Information</h3>
          <button class="edit-btn" id="editPersonalBtn">âœï¸ Edit</button>
        </div>
        <form id="personalForm" class="profile-form">
          <div class="form-row">
            <div class="form-group">
              <label>First Name</label>
              <input type="text" id="firstName" disabled>
            </div>
            <div class="form-group">
              <label>Last Name</label>
              <input type="text" id="lastName" disabled>
            </div>
          </div>
          <div class="form-group">
            <label>Email Address</label>
            <input type="email" id="email" disabled>
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" id="phone" disabled>
          </div>
          <button type="submit" class="btn-primary save-btn" style="display: none;">Save Changes</button>
        </form>
      </div>

      <div class="profile-card">
        <div class="card-header-row">
          <h3>ğŸ“ Address Information</h3>
          <button class="edit-btn" id="editAddressBtn">âœï¸ Edit</button>
        </div>
        <form id="addressForm" class="profile-form">
          <div class="form-group">
            <label>Street Address</label>
            <input type="text" id="street" placeholder="Enter street address" disabled>
          </div>
          <div class="form-group">
            <label>City</label>
            <input type="text" id="city" placeholder="Enter city" disabled>
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" id="state" placeholder="Enter state" disabled>
          </div>
          <div class="form-group">
            <label>ZIP Code</label>
            <input type="text" id="zip" placeholder="Enter ZIP code" disabled>
          </div>
          <button type="submit" class="btn-primary save-btn" style="display: none;">Save Changes</button>
        </form>
      </div>
    </div>

    <div class="profile-card full-width" id="history">
      <div class="card-header-row">
        <h3>ğŸ“œ Recent Service History</h3>
      </div>
      <div class="service-history">
        <div class="history-item">
          <div class="history-icon">ğŸ§¹</div>
          <div class="history-info">
            <h4>House Cleaning</h4>
            <p>3-bedroom house deep cleaning â€¢ Jan 15, 2024</p>
          </div>
          <span class="status-badge completed">Completed</span>
        </div>
        <div class="history-item">
          <div class="history-icon">ğŸ”§</div>
          <div class="history-info">
            <h4>Plumbing Repair</h4>
            <p>Kitchen sink leak repair â€¢ Jan 12, 2024</p>
          </div>
          <span class="status-badge completed">Completed</span>
        </div>
        <div class="history-item">
          <div class="history-icon">âš¡</div>
          <div class="history-info">
            <h4>Electrical Work</h4>
            <p>Light fixture installation â€¢ Jan 8, 2024</p>
          </div>
          <span class="status-badge pending">Pending</span>
        </div>
        <div class="history-item">
          <div class="history-icon">ğŸ¨</div>
          <div class="history-info">
            <h4>Interior Painting</h4>
            <p>Living room painting service â€¢ Jan 5, 2024</p>
          </div>
          <span class="status-badge completed">Completed</span>
        </div>
      </div>
    </div>

    <div class="profile-card full-width" id="settings">
      <div class="card-header-row">
        <h3>âš™ï¸ Preferences & Settings</h3>
      </div>
      <div class="settings-grid">
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ“§</span>
            <span>Email Notifications</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="emailNotifications" checked>
            <span class="slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ“±</span>
            <span>SMS Notifications</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="smsNotifications">
            <span class="slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ”</span>
            <span>Two-Factor Auth</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="twoFactorAuth">
            <span class="slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ””</span>
            <span>Booking Reminders</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="bookingReminders" checked>
            <span class="slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ’¡</span>
            <span>Service Recommendations</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="serviceRecommendations" checked>
            <span class="slider"></span>
          </label>
        </div>
        <div class="setting-item">
          <div class="setting-info">
            <span class="setting-icon">ğŸ’³</span>
            <span>Auto-Pay</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="autoPay">
            <span class="slider"></span>
          </label>
        </div>
      </div>
    </div>
  </main>

  <script src="auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) {
        window.location.href = 'login.html';
        return;
      }
      
      document.getElementById('profileName').textContent = currentUser.firstName + ' ' + currentUser.lastName;
      document.getElementById('profileType').textContent = currentUser.accountType === 'helper' ? 'Service Provider' : 'Customer';
      document.getElementById('profileAvatar').textContent = currentUser.firstName.charAt(0).toUpperCase();
      
      document.getElementById('firstName').value = currentUser.firstName || '';
      document.getElementById('lastName').value = currentUser.lastName || '';
      document.getElementById('email').value = currentUser.email || '';
      document.getElementById('phone').value = currentUser.phone || '';
      
      if (currentUser.address) {
        document.getElementById('street').value = currentUser.address.street || '';
        document.getElementById('city').value = currentUser.address.city || '';
        document.getElementById('state').value = currentUser.address.state || '';
        document.getElementById('zip').value = currentUser.address.zip || '';
      }
      
      if (currentUser.preferences) {
        document.getElementById('emailNotifications').checked = currentUser.preferences.emailNotifications;
        document.getElementById('smsNotifications').checked = currentUser.preferences.smsNotifications;
        document.getElementById('twoFactorAuth').checked = currentUser.preferences.twoFactorAuth;
        document.getElementById('bookingReminders').checked = currentUser.preferences.bookingReminders;
      }
      
      function setupEditButton(btnId, formId) {
        const btn = document.getElementById(btnId);
        const form = document.getElementById(formId);
        const inputs = form.querySelectorAll('input');
        const saveBtn = form.querySelector('.save-btn');
        
        btn.addEventListener('click', function() {
          const isEditing = btn.textContent.includes('Edit');
          if (isEditing) {
            inputs.forEach(input => input.disabled = false);
            saveBtn.style.display = 'block';
            btn.textContent = 'âŒ Cancel';
          } else {
            inputs.forEach(input => input.disabled = true);
            saveBtn.style.display = 'none';
            btn.textContent = 'âœï¸ Edit';
            loadUserData();
          }
        });
      }
      
      function loadUserData() {
        const user = JSON.parse(localStorage.getItem('currentUser'));
        document.getElementById('firstName').value = user.firstName || '';
        document.getElementById('lastName').value = user.lastName || '';
        document.getElementById('email').value = user.email || '';
        document.getElementById('phone').value = user.phone || '';
        if (user.address) {
          document.getElementById('street').value = user.address.street || '';
          document.getElementById('city').value = user.address.city || '';
          document.getElementById('state').value = user.address.state || '';
          document.getElementById('zip').value = user.address.zip || '';
        }
      }
      
      setupEditButton('editPersonalBtn', 'personalForm');
      setupEditButton('editAddressBtn', 'addressForm');
      
      document.getElementById('personalForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const userIndex = users.findIndex(u => u.id === currentUser.id);
        
        currentUser.firstName = document.getElementById('firstName').value;
        currentUser.lastName = document.getElementById('lastName').value;
        currentUser.email = document.getElementById('email').value;
        currentUser.phone = document.getElementById('phone').value;
        
        if (userIndex !== -1) {
          users[userIndex] = currentUser;
          localStorage.setItem('users', JSON.stringify(users));
        }
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        document.getElementById('profileName').textContent = currentUser.firstName + ' ' + currentUser.lastName;
        
        this.querySelectorAll('input').forEach(input => input.disabled = true);
        this.querySelector('.save-btn').style.display = 'none';
        document.getElementById('editPersonalBtn').textContent = 'âœï¸ Edit';
        
        alert('Personal information saved!');
      });
      
      document.getElementById('addressForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const userIndex = users.findIndex(u => u.id === currentUser.id);
        
        currentUser.address = {
          street: document.getElementById('street').value,
          city: document.getElementById('city').value,
          state: document.getElementById('state').value,
          zip: document.getElementById('zip').value
        };
        
        if (userIndex !== -1) {
          users[userIndex] = currentUser;
          localStorage.setItem('users', JSON.stringify(users));
        }
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        this.querySelectorAll('input').forEach(input => input.disabled = true);
        this.querySelector('.save-btn').style.display = 'none';
        document.getElementById('editAddressBtn').textContent = 'âœï¸ Edit';
        
        alert('Address saved!');
      });
      
      document.querySelectorAll('.toggle-switch input').forEach(toggle => {
        toggle.addEventListener('change', function() {
          const users = JSON.parse(localStorage.getItem('users') || '[]');
          const userIndex = users.findIndex(u => u.id === currentUser.id);
          
          if (!currentUser.preferences) currentUser.preferences = {};
          currentUser.preferences[this.id] = this.checked;
          
          if (userIndex !== -1) {
            users[userIndex] = currentUser;
            localStorage.setItem('users', JSON.stringify(users));
          }
          localStorage.setItem('currentUser', JSON.stringify(currentUser));
        });
      });
      
      document.getElementById('logoutBtn').addEventListener('click', function() {
        localStorage.removeItem('currentUser');
        window.location.href = 'welcome.html';
      });
    });
  </script>
</body>
</html>